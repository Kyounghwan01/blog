(window.webpackJsonp=window.webpackJsonp||[]).push([[246],{626:function(t,a,s){"use strict";s.r(a);var r=s(21),e=Object(r.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"ecr-사용법"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ecr-사용법"}},[t._v("#")]),t._v(" ecr 사용법")]),t._v(" "),s("h2",{attrs:{id:"ecr-설정-가이드"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ecr-설정-가이드"}},[t._v("#")]),t._v(" ECR 설정 가이드")]),t._v(" "),s("p",[t._v("ECR(Elastic Container Registry)은 AWS에서 제공하는 완전 관리형 Docker 컨테이너 레지스트리입니다. Docker 이미지를 안전하게 저장, 관리, 배포할 수 있습니다.")]),t._v(" "),s("iframe",{staticStyle:{border:"1px solid #ccc"},attrs:{src:"/blog/ecr.pdf",width:"100%",height:"800px"}}),t._v(" "),s("h2",{attrs:{id:"ecr-개요"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ecr-개요"}},[t._v("#")]),t._v(" ECR 개요")]),t._v(" "),s("p",[t._v("ECR은 Docker 컨테이너 이미지를 저장하고 관리하는 AWS의 완전 관리형 서비스입니다. CodeBuild, ECS, App Runner 등과 통합하여 컨테이너 기반 애플리케이션을 배포할 수 있습니다.")]),t._v(" "),s("h2",{attrs:{id:"⚠️-중요-사전-요구사항"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#⚠️-중요-사전-요구사항"}},[t._v("#")]),t._v(" ⚠️ 중요: 사전 요구사항")]),t._v(" "),s("p",[s("strong",[t._v("CodeBuild가 먼저 선행되어야 합니다!")])]),t._v(" "),s("p",[t._v("ECR 리포지토리를 생성하기 전에 CodeBuild 프로젝트가 설정되어 있어야 합니다. CodeBuild에서 빌드한 Docker 이미지를 ECR에 푸시하기 때문입니다.")]),t._v(" "),s("h2",{attrs:{id:"ecr-리포지토리-생성"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ecr-리포지토리-생성"}},[t._v("#")]),t._v(" ECR 리포지토리 생성")]),t._v(" "),s("h3",{attrs:{id:"_1-리포지토리-생성"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-리포지토리-생성"}},[t._v("#")]),t._v(" 1. 리포지토리 생성")]),t._v(" "),s("p",[s("strong",[t._v("생성 링크:")])]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://ap-northeast-1.console.aws.amazon.com/ecr/private-registry/repositories/create?region=ap-northeast-1",target:"_blank",rel:"noopener noreferrer"}},[t._v("ECR 리포지토리 생성"),s("OutboundLink")],1)])]),t._v(" "),s("p",[s("strong",[t._v("⚠️ 중요: 리포지토리 이름 규칙")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("CodeBuild 프로젝트 이름과 동일하게")]),t._v(" 지어야 합니다")]),t._v(" "),s("li",[t._v("빌드된 이미지가 App Runner나 ECS로 매칭되기 용이합니다")]),t._v(" "),s("li",[t._v("예시: CodeBuild 프로젝트가 "),s("code",[t._v("pet-web")]),t._v("이면 ECR 리포지토리도 "),s("code",[t._v("pet-web")])])]),t._v(" "),s("p",[s("strong",[t._v("리포지토리 설정:")])]),t._v(" "),s("ul",[s("li",[t._v("리포지토리 이름: CodeBuild 프로젝트 이름과 동일")]),t._v(" "),s("li",[t._v("가시성: Private (기본값)")]),t._v(" "),s("li",[t._v("태그 불변성: 필요에 따라 설정")]),t._v(" "),s("li",[t._v("이미지 스캔: 필요에 따라 활성화")])]),t._v(" "),s("h3",{attrs:{id:"_2-생성-확인"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-생성-확인"}},[t._v("#")]),t._v(" 2. 생성 확인")]),t._v(" "),s("p",[t._v("리포지토리 생성이 완료되면:")]),t._v(" "),s("ol",[s("li",[s("p",[s("strong",[t._v("CodeBuild 실행")])]),t._v(" "),s("ul",[s("li",[t._v("CodeBuild 프로젝트를 실행하여 Docker 이미지 빌드 및 푸시")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("ECR에서 이미지 확인")])]),t._v(" "),s("ul",[s("li",[t._v("ECR 콘솔에서 리포지토리 선택")]),t._v(" "),s("li",[t._v("이미지가 정상적으로 푸시되었는지 확인")]),t._v(" "),s("li",[t._v("이미지 태그, 푸시 시간, 이미지 크기 등 확인")])])])]),t._v(" "),s("h2",{attrs:{id:"ecr과-다른-aws-서비스-통합"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ecr과-다른-aws-서비스-통합"}},[t._v("#")]),t._v(" ECR과 다른 AWS 서비스 통합")]),t._v(" "),s("h3",{attrs:{id:"codebuild-연동"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#codebuild-연동"}},[t._v("#")]),t._v(" CodeBuild 연동")]),t._v(" "),s("p",[t._v("CodeBuild의 "),s("code",[t._v("buildspec.yml")]),t._v("에서 ECR에 이미지를 푸시합니다:")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("post_build")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("commands")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" aws ecr get"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("login"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("password "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("region $AWS_DEFAULT_REGION "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" docker login "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("username AWS "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("password"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("stdin $ECR_URI\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" docker push $ECR_URI"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("$IMAGE_TAG\n")])])]),s("h3",{attrs:{id:"ecs-연동"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ecs-연동"}},[t._v("#")]),t._v(" ECS 연동")]),t._v(" "),s("p",[t._v("ECS 태스크 정의에서 ECR 이미지를 참조합니다:")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"image"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"123456789012.dkr.ecr.ap-northeast-2.amazonaws.com/pet-web:latest"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pet-web-container"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"app-runner-연동"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#app-runner-연동"}},[t._v("#")]),t._v(" App Runner 연동")]),t._v(" "),s("p",[t._v("App Runner 서비스 생성 시 ECR 이미지를 소스로 선택합니다:")]),t._v(" "),s("ul",[s("li",[t._v("ECR 리포지토리 선택")]),t._v(" "),s("li",[t._v("이미지 태그 지정")]),t._v(" "),s("li",[t._v("자동 배포 설정")])]),t._v(" "),s("h2",{attrs:{id:"리포지토리-이름-규칙"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#리포지토리-이름-규칙"}},[t._v("#")]),t._v(" 리포지토리 이름 규칙")]),t._v(" "),s("p",[s("strong",[t._v("권장 사항:")])]),t._v(" "),s("ul",[s("li",[t._v("CodeBuild 프로젝트 이름과 동일")]),t._v(" "),s("li",[t._v("소문자, 숫자, 하이픈(-)만 사용")]),t._v(" "),s("li",[t._v("예시: "),s("code",[t._v("pet-web")]),t._v(", "),s("code",[t._v("api-server")]),t._v(", "),s("code",[t._v("frontend-app")])])]),t._v(" "),s("p",[s("strong",[t._v("이유:")])]),t._v(" "),s("ul",[s("li",[t._v("CI/CD 파이프라인에서 일관성 유지")]),t._v(" "),s("li",[t._v("자동화 스크립트 작성 시 변수 관리 용이")]),t._v(" "),s("li",[t._v("배포 시 매칭 오류 방지")])]),t._v(" "),s("h2",{attrs:{id:"이미지-태그-전략"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#이미지-태그-전략"}},[t._v("#")]),t._v(" 이미지 태그 전략")]),t._v(" "),s("p",[s("strong",[t._v("태그 유형:")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("latest")]),t._v(": 최신 빌드 (기본값)")]),t._v(" "),s("li",[s("code",[t._v("v1.0.0")]),t._v(": 버전 태그")]),t._v(" "),s("li",[s("code",[t._v("main-abc123")]),t._v(": 브랜치-커밋 해시")]),t._v(" "),s("li",[s("code",[t._v("staging")]),t._v(", "),s("code",[t._v("production")]),t._v(": 환경별 태그")])]),t._v(" "),s("p",[s("strong",[t._v("권장 사항:")])]),t._v(" "),s("ul",[s("li",[t._v("프로덕션 환경에서는 "),s("code",[t._v("latest")]),t._v(" 태그 사용 지양")]),t._v(" "),s("li",[t._v("버전 태그나 커밋 해시 사용 권장")]),t._v(" "),s("li",[t._v("환경별 태그로 배포 관리")])]),t._v(" "),s("h2",{attrs:{id:"보안-설정"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#보안-설정"}},[t._v("#")]),t._v(" 보안 설정")]),t._v(" "),s("h3",{attrs:{id:"이미지-스캔"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#이미지-스캔"}},[t._v("#")]),t._v(" 이미지 스캔")]),t._v(" "),s("ul",[s("li",[t._v("취약점 스캔 활성화 권장")]),t._v(" "),s("li",[t._v("스캔 결과를 CloudWatch로 전송 가능")])]),t._v(" "),s("h3",{attrs:{id:"태그-불변성"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#태그-불변성"}},[t._v("#")]),t._v(" 태그 불변성")]),t._v(" "),s("ul",[s("li",[t._v("이미지 태그 덮어쓰기 방지")]),t._v(" "),s("li",[t._v("프로덕션 환경에서 권장")])]),t._v(" "),s("h3",{attrs:{id:"iam-정책"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#iam-정책"}},[t._v("#")]),t._v(" IAM 정책")]),t._v(" "),s("ul",[s("li",[t._v("CodeBuild 서비스 역할에 ECR 푸시 권한 필요")]),t._v(" "),s("li",[t._v("ECS/App Runner에 ECR 풀 권한 필요")])]),t._v(" "),s("h2",{attrs:{id:"비용"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#비용"}},[t._v("#")]),t._v(" 비용")]),t._v(" "),s("ul",[s("li",[t._v("저장 비용: GB당 월 요금")]),t._v(" "),s("li",[t._v("데이터 전송: 리전 간 전송 시 비용 발생")]),t._v(" "),s("li",[t._v("스캔: 이미지 스캔 시 추가 비용 (선택사항)")])]),t._v(" "),s("h2",{attrs:{id:"참고사항"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#참고사항"}},[t._v("#")]),t._v(" 참고사항")]),t._v(" "),s("ul",[s("li",[t._v("ECR은 리전별로 독립적으로 운영됩니다")]),t._v(" "),s("li",[t._v("리전 간 이미지 복제가 필요한 경우 별도 설정 필요")]),t._v(" "),s("li",[t._v("이미지 라이프사이클 정책으로 오래된 이미지 자동 삭제 가능")]),t._v(" "),s("li",[t._v("CodeBuild가 ECR에 접근하려면 적절한 IAM 권한이 필요합니다")])]),t._v(" "),s("TagLinks"),t._v(" "),s("Comment")],1)}),[],!1,null,null,null);a.default=e.exports}}]);